<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>starks-proofgen example</title>
  </head>
  <body>
    <script type="module">
      import init, {hashtest,generate_program,starks_proofgen,generate_program_hash,starks_proofgen_with_program_name,output_program_string,output_inputs_string,output_option_string,init_panic_hook} from "./pkg/distaff.js";
      // import init from "./pkg/starks_proofgen.js";
      init().then(m => {
        console.log(1 , m)
                init_panic_hook()
                // merkle hash
                // let b = output_inputs_string("212536982540424896447084657753041636028,62602682562930640774650326019494833305","222681710225944171422886330904366434491,0,68557181380680206116221109328877907882,0,68877343039486781374307978289172110465","269290709893687070873337820426365295693,0,189343189959438333548680818555536049573,1,154997781429020006743060100894063327107")
                // let b = output_inputs_string("111,222","3586102231,11924,20099,40330,126239986506010,194515439315491754531356361705017581862,317097701751359110396564737023410149248","163584248573758124247011040768267472759,105235917359425270697537732270854933106")
               // ⬇️ 这个是kilt credential root的
                // let b = output_inputs_string("","528,311189074552473837668001800292715180257,3523442678,62261,17889,40711,89840307482416,194515439315491754531356361705017581862,90457658405290268147553990996635285742,3235206455,62970,16532,44561,248201482414258,86051990247904266822470237154656440317,73889347862713477327097171224120624546,4200196319,30821,19838,41690,68805128022084,157211099613496641049417004975777857147,311961394196786290997651265402075124671,4253134113,31669,17575,48067,195614649076802,269781719789252286161230702533582314474,137481426361217494534035299220960260701,937678082,53146,17674,39047,139052216724011,264788727686776515939085115610647389018,309299447081900217115392982914725835472","252480570972049094977879398123229768023,163584248573758124247011040768267472759,64401974746417508784439638502889322168,87820060121980488142139625585756264121,165873169578009892867235070762832001381,255623340657534185263079474765697212144,172659092149451661923027031467059363089,257432013315472657421285583973973724834,221612621359750883861760366537409126742,274290926469745048760174327996121017941,280180491899205648968436524606020749934")
                // let b = output_inputs_string("1","333,111,222,444","");
                //⬇️ 这是三个节点的！           
                
                //⬇️ 这是kilt 拆分真实数据 要拼接的！
                // let b = output_inputs_string("1","90457658405290268147553990996635285742,3235206455,62970,16532,44561,248201482414258,22,294843316026996357320061269476730252737,616765,311961394196786290997651265402075124671,137481426361217494534035299220960260701,309299447081900217115392982914725835472","64401974746417508784439638502889322168,127557015350448219066915144450596417715,172659092149451661923027031467059363089,221612621359750883861760366537409126742,280180491899205648968436524606020749934")
                // let f =generate_program("begin dup.1 dup.1 pad.1 lt.128 while.true read.ab roll.4 roll.4 push.1 sub dup.1 pad.1 lt.128 end drop.1 repeat.5 read.a end read.a dup.1 push.20 gt.128 if.true pad.3 else read.ab read.a kvalid roll.4 drop.1 push.4 swap.1 sub dup.1 dup.1 pad.1 lt.128 while.true read.ab roll.4 roll.4 push.1 sub dup.1 pad.1 lt.128 end drop.2 khash push.1 end end") 

                
                // 给节点换顺序
                // let b = output_inputs_string("2","32,31,12,22,42","11,21,41");

                // let b = output_inputs_string("191316898741855275043382750345139265285,296803305817646664683329347328201596143","222681710225944171422886330904366434491,0,68877343039486781374307978289172110465","269290709893687070873337820426365295693,1,154997781429020006743060100894063327107")
                // let b = output_inputs_string("","7,2,3","6,2,6")
                // let b = output_inputs_string("","7,2,5,2,5,7,11,24","3,5,13,4,0,98,3,2")
                // let b = output_inputs_string("1","1,1,1,1,1,1,1","1,1,1,1,1,1,1")

                // console.log("11")
                let c = output_option_string()
                // let d = generate_program("begin read lt.128 if.true pad.1 else push.1 read dup push.1 while.true roll.4 ne if.true swap push.1 add dup push.2 ne if.true  swap dup push.1 else pad.3 end else push.1 pad end end end end")
                // let g = generate_program_hash("begin read lt.128 if.true pad.1 else push.1 read dup push.1 while.true roll.4 ne if.true swap push.1 add dup push.2 ne if.true  swap dup push.1 else pad.3 end else push.1 pad end end end end")


                // let d = generate_program("begin push.0 push.1 push.2 push.4 push.1 read dup push.1 while.true roll.4 ne if.true swap push.1 add dup push.5 ne if.true swap dup push.1 else pad.3 end else push.1 pad end end end")
                // let d = generate_program("begin push.156 push.496 push.408 push.410 push.392 push.608 push.704 push.418 push.116 push.104 push.764 push.458 push.96 push.702 push.360 push.626 push.1 read dup push.1 while.true roll.4 ne if.true swap push.1 add dup push.17 ne if.true swap dup push.1 else pad.3 end else push.1 pad end end end")
                // let g = generate_program_hash("begin push.156 push.496 push.408 push.410 push.392 push.608 push.704 push.418 push.116 push.104 push.764 push.458 push.96 push.702 push.360 push.626 push.1 read dup push.1 while.true roll.4 ne if.true swap push.1 add dup push.17 ne if.true swap dup push.1 else pad.3 end else push.1 pad end end end")

                // let d = generate_program_alone("begin add push.5 mul push.7 end")
                // let f = generate_program("begin push.25 read lt.128 if.true	pad.1 else push.0 push.1 push.2 push.4 push.1 read dup push.1 while.true roll.4 ne if.true swap push.1 add dup push.5 ne if.true swap dup push.1 else pad.3 end else push.1 pad end end end end")

                // console.log("11122")
                // let d = generate_program("begin pad.1 repeat.3 read.ab dup.2 lt.128 if.true pad.1 add else swap.1 end sub dup.1 mul add end end")
                // let d = generate_program("begin pad.1 repeat.8 read.ab dup.2 lt.128 if.true pad.1 add else swap.1 end sub dup.1 mul add end end")


                // let d = generate_program("begin push.1 read dup push.1 while.true roll.4 ne if.true swap push.1 add dup push.2 ne if.true swap dup push.1 else pad.3 end else push.1 pad end end end")
                // let g = generate_program_hash("begin push.1 read dup push.1 while.true roll.4 ne if.true swap push.1 add dup push.2 ne if.true swap dup push.1 else pad.3 end else push.1 pad end end end")


                // let d = generate_program("begin push.1 read dup push.1 while.true roll.4 ne if.true swap push.1 add dup push.3 ne if.true swap dup push.1 else pad.3 end else push.1 pad end end end")
                // let g = generate_program_hash("begin push.1 read dup push.1 while.true roll.4 ne if.true swap push.1 add dup push.3 ne if.true swap dup push.1 else pad.3 end else push.1 pad end end end")
                // ⬇️ 这是kilt的四个credential的

                // let b = output_inputs_string("6383461,121364843949934","2864481297,11060,18159,33711,132378863100738,25,76264564711456200626912835053278337560,4084830804,2443,18069,37930,62029634802367,152,76264564711456200626912835053278337560,279556095869323719447724040100225139341,276262180632226947862112657503897473479,317117113141778722535850715491782072221","169055813545144094809884768883895701729,169055813545144094809884768883895701729,21116054508335819875786693621009039462,31711621678699923421751880602580976486,272400670575332256091272703125420122414")
                // let f = generate_program("begin repeat.5 read.a end read.a dup.1 push.20 gt.128 if.true pad.5 else read.ab kvalid pad.1 pick.3 swap.1 drop.1 roll.4 drop.1 repeat.5 read.a end read.a dup.1 push.152 ne if.true pad.5 else read.ab kvalid repeat.3 read.ab end khash.5 pad.1 push.1 swap.2 roll.4 drop.1 end end end")
                // let g = generate_program_hash("begin repeat.5 read.a end read.a dup.1 push.20 gt.128 if.true pad.5 else read.ab kvalid pad.1 pick.3 swap.1 drop.1 roll.4 drop.1 repeat.5 read.a end read.a dup.1 push.152 ne if.true pad.5 else read.ab kvalid repeat.3 read.ab end khash.5 pad.1 push.1 swap.2 roll.4 drop.1 end end end")


                // let f = generate_program("begin read.ab read.ab read.ab read.ab push.1 push.2 pmpath.4 end")
                let b = output_inputs_string("18","29","")

                let f = generate_program("begin read.a gt.128 end")

                let g = generate_program_hash("begin read.a gt.128 end")

                // let g = generate_program_hash("begin read.a gt.128 end")

                // let f = generate_program("begin read.ab rmerkle.3 swap.2 drop.2 swap.1 roll.4 eq  if.true eq end end")

                // let g = generate_program_hash("begin read.ab rmerkle.3 swap.2 drop.2 swap.1 roll.4 eq  if.true eq end end")

                // let f = generate_program("begin repeat.5 read.a end read.ab blake2b swap.2 drop.2 swap.2 drop.2 swap.2 drop.1 swap.1 roll.4 eq if.true eq else pad.1 end end")
                // 下 kilt credential！
                // let f = generate_program("begin push.1 repeat.5 if.true repeat.5 read.a end read.ab blake2b read.ab pick.2 pick.2 roll.4 eq if.true eq else pad.1 end else pad.1 end end if.true khash swap.1 roll.4 eq if.true eq else pad.1 end else pad.1 end end")
                // let g = generate_program_hash("begin push.1 repeat.5 if.true repeat.5 read.a end read.ab blake2b read.ab pick.2 pick.2 roll.4 eq if.true eq else pad.1 end else pad.1 end end if.true khash swap.1 roll.4 eq if.true eq else pad.1 end else pad.1 end end")
                // push.20 read.a lt.128 if.true	pad.1 else	
                // let f = generate_program("begin push.528 read.a ne if.true	pad.3 else read.ab push.1 repeat.5 if.true repeat.5 read.a end read.ab blake2b read.ab pick.2 pick.2 roll.4 eq if.true eq else pad.2 end else pad.1 end end if.true khash swap.1 roll.4 pick.1 eq if.true dup.1 swap.2 pick.1 eq else pad.2 push.1 end else pad.2 push.1 end end end")
                // let g = generate_program_hash("begin push.528 read.a ne if.true	pad.3 else read.ab push.1 repeat.5 if.true repeat.5 read.a end read.ab blake2b read.ab pick.2 pick.2 roll.4 eq if.true eq else pad.2 end else pad.1 end end if.true khash swap.1 roll.4 pick.1 eq if.true dup.1 swap.2 pick.1 eq else pad.2 push.1 end else pad.2 push.1 end end end")
                
              // 换叶子节点顺序 （with public input）
              //  let f = generate_program("begin read.a read.a push.0 roll.4 swap.1 drop.1 dup.1 push.3 swap.1 sub swap.1 push.1 while.true dup.1 push.0 lt.128 if.true read.ab pad.2 swap.2 swap.4 roll.8 roll.8 drop.2 push.1 sub push.1 else noop end end dup.1 pad.1 lt.128 while.true read.ab pad.1 roll.4 swap.1 drop.1 push.1 sub dup.1 pad.1 lt.128 end drop.1 end ")
                // let f = generate_program("begin repeat.5 read.a end read.a dup.1 push.20 gt.128 if.true pad.3 else read.ab read.a kvalid push.0 roll.4 swap.1 drop.1 dup.1 push.4 swap.1 sub swap.1 push.1 while.true dup.1 push.0 lt.128 if.true read.ab pad.2 swap.2 swap.4 roll.8 roll.8 drop.2 push.1 sub push.1 else noop end end dup.1 pad.1 lt.128 while.true read.ab pad.1 roll.4 swap.1 drop.1 push.1 sub dup.1 pad.1 lt.128 end drop.1 khash push.1 end end")
                //eq if.true eq else pad.1 end
                //read.ab pick.2 pick.2 swap.1 roll.4 eq if.true eq else pad.1 end 
                // let f = generate_program("begin read.a lt.128 if.true pad.1 else read.a eq end end ")
                console.log(starks_proofgen(f,b,8,c))
                console.log(g)
              }).catch(console.error);
      </script>
  </body>
</html>